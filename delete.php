fgf
new changes for optimization
